<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GameHub - Premium Gaming Experience</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="dark-theme">
  <header class="header-dark">
    <div class="header-container">
      <div class="logo">
        <h1>ğŸ® GAMEHUB</h1>
      </div>
      <div id="authSection" class="auth-buttons"></div>
    </div>
  </header>

  <main class="container-dark">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-content">
        <h1 class="hero-title">Welcome to GameHub</h1>
        <p class="hero-subtitle">Premium collection of 16 handcrafted games with betting & rewards</p>
      </div>
      <div id="userInfo" class="user-banner">
        <p>ğŸ¯ Login or Register to unlock betting, rewards & leaderboards!</p>
      </div>
    </section>

    <!-- Multiplayer Server Selection Section -->
    <section class="server-section">
      <div class="section-header">
        <h2><span class="section-icon">ğŸ®</span> Multiplayer Servers</h2>
        <span class="section-count" id="serverCount">0 Active</span>
      </div>
      
      <div class="server-controls">
        <button class="create-server-btn" onclick="showCreateServerModal()">
          <span class="btn-icon">â•</span>
          <span>Create Server</span>
        </button>
        <button class="refresh-servers-btn" onclick="refreshServers()">
          <span class="btn-icon">ğŸ”„</span>
          <span>Refresh</span>
        </button>
      </div>

      <div class="servers-container" id="serversContainer">
        <div class="no-servers-message">
          <div class="no-servers-icon">ğŸ¯</div>
          <h3>No Active Servers</h3>
          <p>Be the first to create a multiplayer game server!</p>
        </div>
      </div>
    </section>

    <!-- Classic Games Section -->
    <section class="games-section-dark">
      <div class="section-header">
        <h2><span class="section-icon">ğŸ•¹ï¸</span> Classic Arcade</h2>
        <span class="section-count">5 Games</span>
      </div>
      <div class="games-grid-modern">
        <div class="game-card-modern classic">
          <div class="card-banner">
            <span class="game-icon">ğŸ</span>
            <span class="difficulty easy">Easy</span>
          </div>
          <div class="card-content">
            <h3>Snake</h3>
            <p class="game-desc">Classic arcade snake game. Eat, grow, survive!</p>
            <div class="game-tags">
              <span class="tag">Arcade</span>
              <span class="tag">Retro</span>
            </div>
          </div>
          <a href="/games/snake.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern classic">
          <div class="card-banner">
            <span class="game-icon">ğŸ¦</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>Flappy Bird</h3>
            <p class="game-desc">Tap to fly through pipes. Test your reflexes!</p>
            <div class="game-tags">
              <span class="tag">Arcade</span>
              <span class="tag">Skill</span>
            </div>
          </div>
          <a href="/games/flappy-bird.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern classic">
          <div class="card-banner">
            <span class="game-icon">ğŸ§ </span>
            <span class="difficulty easy">Easy</span>
          </div>
          <div class="card-content">
            <h3>Memory Match</h3>
            <p class="game-desc">Find matching pairs. Train your memory!</p>
            <div class="game-tags">
              <span class="tag">Puzzle</span>
              <span class="tag">Brain</span>
            </div>
          </div>
          <a href="/games/memory.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern classic">
          <div class="card-banner">
            <span class="game-icon">ğŸ”¢</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>2048</h3>
            <p class="game-desc">Merge tiles to reach 2048. Addictive puzzle!</p>
            <div class="game-tags">
              <span class="tag">Puzzle</span>
              <span class="tag">Strategy</span>
            </div>
          </div>
          <a href="/games/2048.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern classic">
          <div class="card-banner">
            <span class="game-icon">ğŸ”</span>
            <span class="difficulty hard">Hard</span>
          </div>
          <div class="card-content">
            <h3>Crossy Road</h3>
            <p class="game-desc">Cross roads & rivers. Don't get hit!</p>
            <div class="game-tags">
              <span class="tag">Arcade</span>
              <span class="tag">Action</span>
            </div>
          </div>
          <a href="/games/crossy-road.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>
      </div>
    </section>

    <!-- Multiplayer Games Section -->
    <section class="games-section-dark">
      <div class="section-header">
        <h2><span class="section-icon">ğŸ¯</span> Multiplayer Arena</h2>
        <span class="section-count">4 Games</span>
      </div>
      <div class="games-grid-modern">
        <div class="game-card-modern multiplayer">
          <div class="card-banner">
            <span class="game-icon">âŒâ­•</span>
            <span class="difficulty easy">Easy</span>
          </div>
          <div class="card-content">
            <h3>Tic Tac Toe</h3>
            <p class="game-desc">Classic X & O. Beat your opponent online!</p>
            <div class="game-tags">
              <span class="tag">Multiplayer</span>
              <span class="tag">Quick</span>
            </div>
          </div>
          <a href="/games/tic-tac-toe.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern multiplayer">
          <div class="card-banner">
            <span class="game-icon">ğŸ£</span>
            <span class="difficulty easy">Easy</span>
          </div>
          <div class="card-content">
            <h3>Go Fish</h3>
            <p class="game-desc">Classic card game. Match pairs & collect sets!</p>
            <div class="game-tags">
              <span class="tag">Cards</span>
              <span class="tag">Casual</span>
            </div>
          </div>
          <a href="/games/go-fish.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern multiplayer">
          <div class="card-banner">
            <span class="game-icon">ğŸ´</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>UNO</h3>
            <p class="game-desc">Match colors & numbers. First to empty wins!</p>
            <div class="game-tags">
              <span class="tag">Cards</span>
              <span class="tag">Strategy</span>
            </div>
          </div>
          <a href="/games/uno.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern multiplayer">
          <div class="card-banner">
            <span class="game-icon">ğŸƒ</span>
            <span class="difficulty hard">Hard</span>
          </div>
          <div class="card-content">
            <h3>Poker</h3>
            <p class="game-desc">Texas Hold'em. Bluff, bet & win big!</p>
            <div class="game-tags">
              <span class="tag">Cards</span>
              <span class="tag">Betting</span>
            </div>
          </div>
          <a href="/games/poker.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>
      </div>
    </section>

    <!-- Casino Games Section -->
    <section class="games-section-dark">
      <div class="section-header">
        <h2><span class="section-icon">ğŸ°</span> Casino & Betting</h2>
        <span class="section-count">7 Games</span>
      </div>
      <div class="games-grid-modern">
        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸ“</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>Plinko</h3>
            <p class="game-desc">Drop the ball, watch it bounce. Big rewards!</p>
            <div class="game-tags">
              <span class="tag">Casino</span>
              <span class="tag">Luck</span>
            </div>
          </div>
          <a href="/games/plinko.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸª™</span>
            <span class="difficulty easy">Easy</span>
          </div>
          <div class="card-content">
            <h3>Coin Flip</h3>
            <p class="game-desc">Heads or tails? Double your coins instantly!</p>
            <div class="game-tags">
              <span class="tag">Casino</span>
              <span class="tag">Quick</span>
            </div>
          </div>
          <a href="/games/coinflip.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸ¡</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>Roulette</h3>
            <p class="game-desc">Spin the wheel. Red, black or number bets!</p>
            <div class="game-tags">
              <span class="tag">Casino</span>
              <span class="tag">Classic</span>
            </div>
          </div>
          <a href="/games/roulette.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸ‚¡</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>Blackjack 21</h3>
            <p class="game-desc">Beat the dealer. Get 21 without busting!</p>
            <div class="game-tags">
              <span class="tag">Cards</span>
              <span class="tag">Strategy</span>
            </div>
          </div>
          <a href="/games/blackjack.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸ’</span>
            <span class="difficulty hard">Hard</span>
          </div>
          <div class="card-content">
            <h3>Mines</h3>
            <p class="game-desc">Find diamonds, avoid bombs. High risk, high reward!</p>
            <div class="game-tags">
              <span class="tag">Casino</span>
              <span class="tag">Strategy</span>
            </div>
          </div>
          <a href="/games/mines.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸ°</span>
            <span class="difficulty easy">Easy</span>
          </div>
          <div class="card-content">
            <h3>Slots</h3>
            <p class="game-desc">Spin the reels! Match symbols for huge wins!</p>
            <div class="game-tags">
              <span class="tag">Casino</span>
              <span class="tag">Luck</span>
            </div>
          </div>
          <a href="/games/slots.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>

        <div class="game-card-modern casino">
          <div class="card-banner">
            <span class="game-icon">ğŸš€</span>
            <span class="difficulty medium">Medium</span>
          </div>
          <div class="card-content">
            <h3>Rocket</h3>
            <p class="game-desc">Ride the rocket! Cash out before it crashes!</p>
            <div class="game-tags">
              <span class="tag">Casino</span>
              <span class="tag">Crash</span>
            </div>
          </div>
          <a href="/games/rocket.html" class="play-btn">
            <span>Play Now</span>
            <span class="btn-arrow">â†’</span>
          </a>
        </div>
      </div>
    </section>
  </main>

  <!-- Auth Modal -->
  <div id="authModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <div id="modalContent"></div>
    </div>
  </div>

  <!-- Notification Container -->
  <div id="notificationContainer" class="notification-container"></div>

  <footer class="footer-dark">
    <p>ğŸ® GameHub Â© 2025 | Play Responsibly | 16 Premium Games</p>
  </footer>

  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script src="js/main.js"></script>
  <script>
    // Multiplayer Server Management - Constants
    const SOCKET_CONNECTION_DELAY = 1000; // ms to wait for socket connection
    const SERVER_REFRESH_INTERVAL = 10000; // ms between server list refreshes
    
    const MULTIPLAYER_GAMES = [
      { id: 'tic-tac-toe', name: 'Tic Tac Toe', emoji: 'âŒâ­•' },
      { id: 'poker', name: 'Poker', emoji: 'ğŸƒ' },
      { id: 'uno', name: 'UNO', emoji: 'ğŸ´' },
      { id: 'go-fish', name: 'Go Fish', emoji: 'ğŸ£' }
    ];
    
    const GAME_EMOJIS = Object.fromEntries(
      MULTIPLAYER_GAMES.map(game => [game.id, game.emoji])
    );
    
    // State
    let activeServers = [];
    
    // Initialize socket connection for multiplayer
    let socket;
    if (typeof io !== 'undefined') {
      socket = io();
      
      socket.on('rooms-list', (data) => {
        activeServers = data.rooms || [];
        updateServersList();
      });
      
      socket.on('room-created', (data) => {
        if (data.success) {
          showNotification('Server created successfully! ğŸ®', 'success');
          refreshServers();
        }
      });
      
      socket.on('room-joined', (data) => {
        if (data.success) {
          showNotification('Joined server successfully! ğŸ®', 'success');
          // Redirect to the game
          window.location.href = data.room.gameUrl;
        }
      });
    }
    
    function showCreateServerModal() {
      if (!currentUser) {
        showNotification('Please login to create a server', 'error');
        showLoginModal();
        return;
      }
      
      const modalContent = `
        <div class="modal-header">
          <h2>ğŸ® Create Multiplayer Server</h2>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Select Game:</label>
            <select id="serverGameType" class="form-input">
              ${MULTIPLAYER_GAMES.map(game => 
                `<option value="${game.id}">${game.emoji} ${game.name}</option>`
              ).join('')}
            </select>
          </div>
          <div class="form-group">
            <label>Server Name:</label>
            <input type="text" id="serverName" class="form-input" placeholder="My Awesome Server" maxlength="30">
          </div>
          <div class="form-group">
            <label>Max Players:</label>
            <select id="maxPlayers" class="form-input">
              <option value="2">2 Players</option>
              <option value="3">3 Players</option>
              <option value="4" selected>4 Players</option>
              <option value="6">6 Players</option>
            </select>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="isPrivate"> Private Server (Invite only)
            </label>
          </div>
          <button onclick="createServer()" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Create Server</button>
        </div>
      `;
      
      document.getElementById('modalContent').innerHTML = modalContent;
      document.getElementById('authModal').style.display = 'block';
    }
    
    function createServer() {
      const gameType = document.getElementById('serverGameType').value;
      const serverName = document.getElementById('serverName').value || currentUser.username + "'s Server";
      const maxPlayers = parseInt(document.getElementById('maxPlayers').value);
      const isPrivate = document.getElementById('isPrivate').checked;
      
      if (socket) {
        socket.emit('create-room', {
          gameType,
          playerData: {
            userId: currentUser.id,
            username: currentUser.username,
            coins: userCoins
          },
          settings: {
            name: serverName,
            maxPlayers,
            isPrivate
          }
        });
        
        closeModal();
      } else {
        showNotification('Connection error. Please refresh the page.', 'error');
      }
    }
    
    function refreshServers() {
      if (socket) {
        // Request servers for all multiplayer games
        MULTIPLAYER_GAMES.forEach(game => {
          socket.emit('get-rooms', { gameType: game.id });
        });
      }
    }
    
    function joinServer(roomId) {
      if (!currentUser) {
        showNotification('Please login to join a server', 'error');
        showLoginModal();
        return;
      }
      
      if (socket) {
        socket.emit('join-room', {
          roomId,
          playerData: {
            userId: currentUser.id,
            username: currentUser.username,
            coins: userCoins
          }
        });
      }
    }
    
    function updateServersList() {
      const container = document.getElementById('serversContainer');
      const countEl = document.getElementById('serverCount');
      
      if (!activeServers || activeServers.length === 0) {
        container.innerHTML = `
          <div class="no-servers-message">
            <div class="no-servers-icon">ğŸ¯</div>
            <h3>No Active Servers</h3>
            <p>Be the first to create a multiplayer game server!</p>
          </div>
        `;
        countEl.textContent = '0 Active';
        return;
      }
      
      countEl.textContent = activeServers.length + ' Active';
      
      container.innerHTML = activeServers.map(server => {
        const statusClass = server.status === 'playing' ? 'playing' : 'waiting';
        const statusText = server.status === 'playing' ? 'In Progress' : 'Waiting';
        
        return `
          <div class="server-card ${statusClass}">
            <div class="server-header">
              <div class="server-game">${GAME_EMOJIS[server.gameType] || 'ğŸ®'} ${server.settings?.name || 'Unnamed Server'}</div>
              <div class="server-status ${statusClass}">${statusText}</div>
            </div>
            <div class="server-info">
              <div class="server-players">
                <span class="info-icon">ğŸ‘¥</span>
                <span>${server.players.length}/${server.maxPlayers}</span>
              </div>
              <div class="server-host">
                <span class="info-icon">ğŸ‘‘</span>
                <span>${server.hostName || 'Host'}</span>
              </div>
            </div>
            <button 
              class="join-server-btn" 
              onclick="joinServer('${server.id}')"
              ${server.status === 'playing' || server.players.length >= server.maxPlayers ? 'disabled' : ''}
            >
              ${server.status === 'playing' ? 'â¸ï¸ In Progress' : server.players.length >= server.maxPlayers ? 'ğŸ”’ Full' : 'â–¶ï¸ Join Server'}
            </button>
          </div>
        `;
      }).join('');
    }
    
    // Load servers on page load
    document.addEventListener('DOMContentLoaded', () => {
      // Small delay to ensure socket is connected
      setTimeout(() => {
        refreshServers();
      }, SOCKET_CONNECTION_DELAY);
      
      // Refresh servers every 10 seconds
      setInterval(refreshServers, SERVER_REFRESH_INTERVAL);
    });
  </script>
</body>
</html>
