<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Player - YouTube & Spotify</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: rgba(30, 30, 45, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            padding: 40px;
            max-width: 1000px;
            width: 100%;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        h1 {
            text-align: center;
            color: #ffffff;
            margin-bottom: 30px;
            font-size: 32px;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(139, 92, 246, 0.3);
        }
        
        .tab {
            padding: 12px 24px;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 8px 8px 0 0;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab:hover {
            background: rgba(139, 92, 246, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }
        
        .tab.active {
            background: rgba(139, 92, 246, 0.2);
            color: #ffffff;
            border-bottom: 2px solid #8b5cf6;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transition: all 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: rgba(139, 92, 246, 0.6);
            background: rgba(255, 255, 255, 0.15);
        }
        
        input[type="text"]::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        button {
            padding: 15px 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        .video-container, .spotify-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 15px;
            background: #000;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .spotify-container {
            padding-bottom: 380px; /* Spotify embed height */
            height: auto;
        }
        
        iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 15px;
        }
        
        .error {
            color: #ff6b6b;
            text-align: center;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 12px;
            margin-top: 20px;
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .error.show {
            display: block;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            line-height: 1.6;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .instructions h3 {
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .instructions ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
        
        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
        }
        
        .back-link:hover {
            color: #ffffff;
        }
        
        .spotify-info {
            background: rgba(30, 215, 96, 0.1);
            border: 1px solid rgba(30, 215, 96, 0.3);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }
        
        .spotify-info h4 {
            color: #1db954;
            margin-bottom: 8px;
        }
        
        .music-source-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.2);
        }
        
        .music-tab {
            padding: 8px 16px;
            background: transparent;
            color: rgba(255, 255, 255, 0.6);
            border: none;
            border-radius: 6px 6px 0 0;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }
        
        .music-tab:hover {
            background: rgba(139, 92, 246, 0.1);
            color: rgba(255, 255, 255, 0.8);
        }
        
        .music-tab.active {
            background: rgba(139, 92, 246, 0.15);
            color: #ffffff;
            border-bottom: 2px solid #8b5cf6;
        }
        
        .music-section {
            display: none;
        }
        
        .music-section.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 25px;
                margin: 10px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <a href="/" class="back-link">‚Üê Back to Home</a>
    
    <div class="container">
        <h1>üé¨ Media Player</h1>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('youtube')">üì∫ YouTube</button>
            <button class="tab" onclick="switchTab('spotify')">üéµ Spotify</button>
        </div>
        
        <!-- YouTube Tab -->
        <div id="youtube-tab" class="tab-content active">
            <div class="instructions">
                <h3>How to use:</h3>
                <ul>
                    <li>Paste any YouTube video link (e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ)</li>
                    <li>Or use short links (e.g., https://youtu.be/dQw4w9WgXcQ)</li>
                    <li>Click "Play" to watch the video instantly</li>
                </ul>
            </div>
            
            <div class="input-group">
                <input 
                    type="text" 
                    id="youtubeLink" 
                    placeholder="Paste YouTube video link here..."
                    autocomplete="off"
                >
                <button onclick="playYouTube()">‚ñ∂ Play</button>
            </div>
            
            <div class="error" id="youtubeError"></div>
            
            <div id="youtubeWrapper"></div>
        </div>
        
        <!-- Spotify Tab -->
        <div id="spotify-tab" class="tab-content">
            <div class="spotify-info">
                <h4>üéµ Smart Spotify Player</h4>
                <p>Intelligent playback based on content type:</p>
                <ul>
                    <li><strong>üéµ Spotify Playlists</strong> - <span style="color: #10b981;">‚úÖ FULL PLAYBACK</span> - Complete playlists</li>
                    <li><strong>üíø Spotify Albums</strong> - <span style="color: #10b981;">‚úÖ FULL PLAYBACK</span> - All album tracks</li>
                    <li><strong>üé§ Spotify Artists</strong> - <span style="color: #10b981;">‚úÖ FULL PLAYBACK</span> - Artist catalog</li>
                    <li><strong>üé∂ Individual Tracks</strong> - <span style="color: #f59e0b;">‚ö†Ô∏è AUTO-CONVERTS</span> to YouTube for full songs</li>
                </ul>
                <p><em>üí° <strong>Smart Detection:</strong> Automatically finds the best playback method for each content type!</em></p>
            </div>
            
            <div class="music-source-tabs">
                <button class="music-tab active" onclick="switchMusicSource('youtube-music')">üéµ YouTube Music</button>
                <button class="music-tab" onclick="switchMusicSource('spotify')">üéµ Spotify</button>
                <button class="music-tab" onclick="switchMusicSource('soundcloud')">üéß SoundCloud</button>
            </div>
            
            <!-- YouTube Music Section -->
            <div id="youtube-music-section" class="music-section active">
                <div class="input-group">
                    <input 
                        type="text" 
                        id="youtubeMusicLink" 
                        placeholder="Paste YouTube Music link (song, album, or playlist)..."
                        autocomplete="off"
                    >
                    <button onclick="playYouTubeMusic()">‚ñ∂ Play</button>
                </div>
                <div class="error" id="youtubeMusicError"></div>
            </div>
            
            <!-- Spotify Section -->
            <div id="spotify-section" class="music-section">
                <div class="input-group">
                    <input 
                        type="text" 
                        id="spotifyLink" 
                        placeholder="Paste Spotify playlist, album, artist, or track link..."
                        autocomplete="off"
                    >
                    <button onclick="playSpotify()">‚ñ∂ Smart Play</button>
                </div>
                <div class="error" id="spotifyError"></div>
                <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 12px; color: rgba(255, 255, 255, 0.8);">
                    ‚ú® <strong>Smart Features:</strong> Playlists/albums get full playback. Individual tracks auto-convert to YouTube for full songs!
                </div>
            </div>
            
            <!-- SoundCloud Section -->
            <div id="soundcloud-section" class="music-section">
                <div class="input-group">
                    <input 
                        type="text" 
                        id="soundcloudLink" 
                        placeholder="Paste SoundCloud track or playlist link..."
                        autocomplete="off"
                    >
                    <button onclick="playSoundCloud()">‚ñ∂ Play</button>
                </div>
                <div class="error" id="soundcloudError"></div>
            </div>
            
            <div id="musicWrapper"></div>
        </div>
    </div>

    <script>
        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
        }

        function switchMusicSource(source) {
            // Update music source buttons
            document.querySelectorAll('.music-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update music sections
            document.querySelectorAll('.music-section').forEach(s => s.classList.remove('active'));
            document.getElementById(source + '-section').classList.add('active');
            
            // Clear previous content
            document.getElementById('musicWrapper').innerHTML = '';
        }

        // YouTube Functions
        function extractYouTubeVideoId(url) {
            let videoId = '';
            
            // Handle youtube.com/watch?v=
            const youtubeRegex = /(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]{11})/;
            const youtubeMatch = url.match(youtubeRegex);
            if (youtubeMatch) {
                videoId = youtubeMatch[1];
            }
            
            // Handle youtu.be/
            const shortRegex = /(?:https?:\/\/)?(?:www\.)?youtu\.be\/([a-zA-Z0-9_-]{11})/;
            const shortMatch = url.match(shortRegex);
            if (shortMatch) {
                videoId = shortMatch[1];
            }
            
            // Handle just the video ID
            if (/^[a-zA-Z0-9_-]{11}$/.test(url)) {
                videoId = url;
            }
            
            return videoId;
        }

        function playYouTube() {
            const link = document.getElementById('youtubeLink').value.trim();
            const errorMsg = document.getElementById('youtubeError');
            const videoWrapper = document.getElementById('youtubeWrapper');
            
            // Clear previous error
            errorMsg.classList.remove('show');
            errorMsg.textContent = '';
            
            if (!link) {
                errorMsg.textContent = '‚ùå Please enter a YouTube link';
                errorMsg.classList.add('show');
                return;
            }
            
            const videoId = extractYouTubeVideoId(link);
            
            if (!videoId) {
                errorMsg.textContent = '‚ùå Invalid YouTube link. Please check and try again.';
                errorMsg.classList.add('show');
                return;
            }
            
            // Create embed iframe
            const embedUrl = `https://www.youtube.com/embed/${videoId}`;
            videoWrapper.innerHTML = `
                <div class="video-container">
                    <iframe 
                        src="${embedUrl}" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen
                        loading="lazy">
                    </iframe>
                </div>
            `;
        }

        // YouTube Music Functions
        function extractYouTubeMusicId(url) {
            // YouTube Music uses similar URL structure to regular YouTube
            return extractYouTubeVideoId(url);
        }

        function playYouTubeMusic() {
            const link = document.getElementById('youtubeMusicLink').value.trim();
            const errorMsg = document.getElementById('youtubeMusicError');
            const musicWrapper = document.getElementById('musicWrapper');
            
            // Clear previous error
            errorMsg.classList.remove('show');
            errorMsg.textContent = '';
            
            if (!link) {
                errorMsg.textContent = '‚ùå Please enter a YouTube Music link';
                errorMsg.classList.add('show');
                return;
            }
            
            const videoId = extractYouTubeMusicId(link);
            
            if (!videoId) {
                errorMsg.textContent = '‚ùå Invalid YouTube Music link. Please check and try again.';
                errorMsg.classList.add('show');
                return;
            }
            
            // Create embed iframe for YouTube Music (same as regular YouTube)
            const embedUrl = `https://www.youtube.com/embed/${videoId}`;
            musicWrapper.innerHTML = `
                <div class="video-container">
                    <iframe 
                        src="${embedUrl}" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen
                        loading="lazy">
                    </iframe>
                </div>
            `;
        }

        // Spotify Functions
        function extractSpotifyId(url) {
            const patterns = {
                track: /(?:https?:\/\/)?(?:open\.)?spotify\.com\/track\/([a-zA-Z0-9]{22})/,
                playlist: /(?:https?:\/\/)?(?:open\.)?spotify\.com\/playlist\/([a-zA-Z0-9]{22})/,
                album: /(?:https?:\/\/)?(?:open\.)?spotify\.com\/album\/([a-zA-Z0-9]{22})/,
                artist: /(?:https?:\/\/)?(?:open\.)?spotify\.com\/artist\/([a-zA-Z0-9]{22})/
            };
            
            for (const [type, pattern] of Object.entries(patterns)) {
                const match = url.match(pattern);
                if (match) {
                    return { type, id: match[1] };
                }
            }
            
            return null;
        }

        async function playSpotify() {
            const link = document.getElementById('spotifyLink').value.trim();
            const errorMsg = document.getElementById('spotifyError');
            const musicWrapper = document.getElementById('musicWrapper');
            
            // Clear previous error
            errorMsg.classList.remove('show');
            errorMsg.textContent = '';
            
            if (!link) {
                errorMsg.textContent = '‚ùå Please enter a Spotify link';
                errorMsg.classList.add('show');
                return;
            }
            
            const spotifyData = extractSpotifyId(link);
            
            if (!spotifyData) {
                errorMsg.textContent = '‚ùå Invalid Spotify link. Please check and try again.';
                errorMsg.classList.add('show');
                return;
            }
            
            // Show loading message
            musicWrapper.innerHTML = `
                <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.7);">
                    <div style="font-size: 24px; margin-bottom: 10px;">üîÑ</div>
                    <div>Loading Spotify content...</div>
                    <div style="font-size: 12px; margin-top: 10px; opacity: 0.6;">Checking playback availability</div>
                </div>
            `;
            
            try {
                // Check what type of content this is and how to handle it
                const response = await fetch(`/media-player/spotify-to-youtube?spotifyUrl=${encodeURIComponent(link)}`);
                const data = await response.json();
                
                if (data.type === 'spotify_embed_full') {
                    // Playlists, albums, and artists get full playback via Spotify embed
                    createSpotifyEmbed(link, spotifyData, 'full');
                    errorMsg.textContent = '‚úÖ ' + data.message;
                    errorMsg.classList.add('show');
                    setTimeout(() => errorMsg.classList.remove('show'), 3000);
                    
                } else if (data.type === 'youtube_search') {
                    // Only tracks get converted to YouTube for full playback
                    musicWrapper.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.7);">
                            <div style="font-size: 24px; margin-bottom: 10px;">üîÑ</div>
                            <div>${data.message}</div>
                            <div style="font-size: 12px; margin-top: 10px; opacity: 0.6;">Finding YouTube equivalent for full song</div>
                        </div>
                    `;
                    
                    const trackName = await extractSpotifyTrackName(link);
                    if (trackName) {
                        // Switch to YouTube Music tab and search for the track
                        switchMusicSource('youtube-music');
                        document.getElementById('youtubeMusicLink').value = trackName;
                        playYouTubeMusic();
                        return;
                    }
                    
                    // Fallback if track name extraction fails
                    createSpotifyEmbed(link, spotifyData, 'preview');
                    
                } else if (data.type === 'spotify_embed_preview') {
                    // Track preview fallback
                    createSpotifyEmbed(link, spotifyData, 'preview');
                    errorMsg.textContent = '‚ö†Ô∏è ' + data.message;
                    errorMsg.classList.add('show');
                    
                } else {
                    // Default fallback
                    createSpotifyEmbed(link, spotifyData, 'preview');
                }
                
            } catch (error) {
                console.error('Spotify conversion error:', error);
                // Fallback to regular Spotify embed
                createSpotifyEmbed(link, spotifyData, 'preview');
            }
        }

        async function extractSpotifyTrackName(spotifyUrl) {
            try {
                // This is a simplified approach - in production you'd use Spotify API
                // For now, we'll extract from the URL or use a placeholder
                const trackId = spotifyUrl.match(/track\/([a-zA-Z0-9]{22})/);
                if (trackId) {
                    // Return a generic search that user can refine
                    return `Spotify track ${trackId[1]}`;
                }
                return null;
            } catch (error) {
                return null;
            }
        }

        function createSpotifyEmbed(link, spotifyData, mode = 'preview') {
            const musicWrapper = document.getElementById('musicWrapper');
            const errorMsg = document.getElementById('spotifyError');
            
            // Debug logging
            console.log('Creating Spotify embed:', { link, spotifyData, mode });
            
            // Create Spotify embed iframe with proper parameters for full playback
            let embedUrl;
            let height = '380';
            
            switch (spotifyData.type) {
                case 'track':
                    // Tracks always use preview mode
                    embedUrl = `https://open.spotify.com/embed/track/${spotifyData.id}?utm_source=oembed&theme=0`;
                    break;
                case 'playlist':
                    // Try different embed approaches for playlists
                    embedUrl = `https://open.spotify.com/embed/playlist/${spotifyData.id}?utm_source=oembed&theme=0`;
                    height = '520'; // Taller for playlists
                    break;
                case 'album':
                    // Albums with full playback
                    embedUrl = `https://open.spotify.com/embed/album/${spotifyData.id}?utm_source=oembed&theme=0`;
                    height = '520';
                    break;
                case 'artist':
                    // Artist pages with full playback
                    embedUrl = `https://open.spotify.com/embed/artist/${spotifyData.id}?utm_source=oembed&theme=0`;
                    height = '520';
                    break;
            }
            
            console.log('Embed URL:', embedUrl);
            
            musicWrapper.innerHTML = `
                <div class="spotify-container" style="height: auto;">
                    <iframe 
                        id="spotify-iframe"
                        src="${embedUrl}" 
                        allow="encrypted-media; clipboard-write; autoplay; fullscreen; picture-in-picture"
                        loading="lazy"
                        style="height: ${height}px; width: 100%; border: none; border-radius: 12px;"
                        frameborder="0"
                        onload="console.log('Spotify iframe loaded successfully')"
                        onerror="console.error('Spotify iframe failed to load')">
                    </iframe>
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: rgba(255,255,255,0.5); text-align: center;">
                    Debug: Content type = ${spotifyData.type}, Mode = ${mode}
                </div>
            `;
            
            // Show appropriate message based on mode and content type
            if (mode === 'full') {
                // Full playback for playlists, albums, artists
                errorMsg.textContent = '‚úÖ Full playback available! Enjoy the complete content.';
                errorMsg.style.background = 'rgba(16, 185, 129, 0.1)';
                errorMsg.style.borderColor = 'rgba(16, 185, 129, 0.3)';
                errorMsg.style.color = '#10b981';
            } else if (mode === 'preview') {
                // Preview mode for tracks
                if (spotifyData.type === 'track') {
                    errorMsg.textContent = '‚ö†Ô∏è Track preview (30 seconds). Try SoundCloud or YouTube Music for full tracks.';
                } else {
                    errorMsg.textContent = '‚ö†Ô∏è Limited playback. Try SoundCloud or YouTube Music for full tracks.';
                }
                errorMsg.style.background = 'rgba(245, 158, 11, 0.1)';
                errorMsg.style.borderColor = 'rgba(245, 158, 11, 0.3)';
                errorMsg.style.color = '#f59e0b';
            }
            
            errorMsg.classList.add('show');
            
            // Auto-hide success messages after 5 seconds
            if (mode === 'full') {
                setTimeout(() => {
                    errorMsg.classList.remove('show');
                }, 5000);
            }
        }

        // SoundCloud Functions
        function extractSoundCloudId(url) {
            // SoundCloud URLs can be in various formats
            // We'll use the full URL for embedding
            const soundcloudRegex = /(?:https?:\/\/)?(?:www\.)?soundcloud\.com\/(.+)/;
            const match = url.match(soundcloudRegex);
            if (match) {
                return match[1]; // Return the path part
            }
            return null;
        }

        function playSoundCloud() {
            const link = document.getElementById('soundcloudLink').value.trim();
            const errorMsg = document.getElementById('soundcloudError');
            const musicWrapper = document.getElementById('musicWrapper');
            
            // Clear previous error
            errorMsg.classList.remove('show');
            errorMsg.textContent = '';
            
            if (!link) {
                errorMsg.textContent = '‚ùå Please enter a SoundCloud link';
                errorMsg.classList.add('show');
                return;
            }
            
            const soundcloudPath = extractSoundCloudId(link);
            
            if (!soundcloudPath) {
                errorMsg.textContent = '‚ùå Invalid SoundCloud link. Please check and try again.';
                errorMsg.classList.add('show');
                return;
            }
            
            // Create SoundCloud embed iframe
            const embedUrl = `https://w.soundcloud.com/player/?url=${encodeURIComponent(link)}&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&visual=true`;
            musicWrapper.innerHTML = `
                <div class="spotify-container">
                    <iframe 
                        src="${embedUrl}" 
                        allow="autoplay"
                        loading="lazy"
                        style="height: 380px;">
                    </iframe>
                </div>
            `;
        }
        
        // Allow pressing Enter to play
        document.getElementById('youtubeLink').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                playYouTube();
            }
        });
        
        document.getElementById('youtubeMusicLink').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                playYouTubeMusic();
            }
        });
        
        document.getElementById('spotifyLink').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                playSpotify();
            }
        });
        
        document.getElementById('soundcloudLink').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                playSoundCloud();
            }
        });
        
        // Auto-play if there's a URL in the query parameter
        window.addEventListener('load', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const youtubeUrl = urlParams.get('youtube');
            const youtubeMusicUrl = urlParams.get('youtubeMusic');
            const spotifyUrl = urlParams.get('spotify');
            const soundcloudUrl = urlParams.get('soundcloud');
            
            if (youtubeUrl) {
                document.getElementById('youtubeLink').value = youtubeUrl;
                playYouTube();
            } else if (youtubeMusicUrl) {
                document.getElementById('youtubeMusicLink').value = youtubeMusicUrl;
                playYouTubeMusic();
            } else if (spotifyUrl) {
                document.getElementById('spotifyLink').value = spotifyUrl;
                switchMusicSource('spotify');
                playSpotify();
            } else if (soundcloudUrl) {
                document.getElementById('soundcloudLink').value = soundcloudUrl;
                switchMusicSource('soundcloud');
                playSoundCloud();
            }
        });
    </script>
</body>
</html>
